"""
Date:        4/10/2025 
Class:       N/A
Description: This file will serve as the main driver file. All objects should be imported
             and orchastrated from here. This should also serve as the main entry point, 
             and parse any arguments passed in the Command Line Interface (CLI)
"""
import utils
from scanners import signature_scanner
from scanners.ScannerController import ScannerController
import database_handler

from scanners import scanner
from scanners import HookScanner
from scanners import FileSizeScanner
from structs import *
logger = utils.logging.getLogger(__name__)

def main():
    utils.setup_logger()
    db = database_handler.Database_Handler()
    # print(db.search_file_scan_repots('C:\\Program Files\\Bonjour SDK\\About Bonjour SDK.rtf'))
    # db.refresh_signatures()
    # scanner = FileSizeScanner.FileSizeScanner(db)
    # print(scanner.process_file_path('C:\\Users\\jacob\\OneDrive\\Documents\\GitHub\\os-networking-final-2025\\malware_tool\\database\\local_db.sqlite'))

    # # db = database_handler.Database_Handler()
    # # db.refresh_signatures()
    # #controller = ScannerController()
    # #ontroller.scan_directory('malware_tool')
    
    # # Run HookScanner
    # hook_scanner = HookScanner.HookScanner(db)
    # results = hook_scanner.scan()

    # logger.info(f"âœ… HookScanner finished. {len(results)} file(s) flagged.")
    # if results:
    #     print("Suspicious files found:")
    # else:
    #     logger.info("No suspicious files found.")
    #     print("No suspicious files found.")

    # # logger.info("ðŸ”š Scan complete.")
    controller = ScannerController()
    # controller.health_scan('C:\\Users\\jacob\\OneDrive\\Documents\\GitHub\\os-networking-final-2025\\')
    controller.health_scan('C:\\Program Files\\')
    # scanner = signature_scanner.SignatureScanner(db)
    # print(scanner.scan("malware_tool"))

    #logger.info(f"âœ… HookScanner finished. {len(results)} file(s) flagged.")
    

if __name__ == "__main__":
    main()