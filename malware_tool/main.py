"""
Date:        4/10/2025 
Class:       N/A
Description: This file will serve as the main driver file. All objects should be imported
             and orchastrated from here. This should also serve as the main entry point, 
             and parse any arguments passed in the Command Line Interface (CLI)
"""
import utils
from scanners import signature_scanner
from scanners.ScannerController import ScannerController
import database_handler

from scanners import scanner
from scanners import HookScanner
from structs import *
logger = utils.logging.getLogger(__name__)

def main():
    utils.setup_logger()
    logger.info("üõ°Ô∏è Malware Scanner Starting...")

    db = database_handler.Database_Handler()

    # Optional: Refresh malware signature DB from Malware Bazaar
    # db.refresh_signatures()

    # db = database_handler.Database_Handler()
    # db.refresh_signatures()
    #controller = ScannerController()
    c#ontroller.scan_directory('malware_tool')
    
    # Run HookScanner
    #hook_scanner = HookScanner.HookScanner(db)
    #results = hook_scanner.scan()

    #logger.info(f"‚úÖ HookScanner finished. {len(results)} file(s) flagged.")
    if results:
        for report in results:
        print(report)
    else:
        logger.info("No suspicious files found.")
        print("No suspicious files found.")

    logger.info("üîö Scan complete.")
    

if __name__ == "__main__":
    main()