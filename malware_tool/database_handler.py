"""
Date:        4/10/2025 
Class:       Database_Handler
Description: This class will be incharge of maintaining and accessing the local db file. The database
             will be SQLite, allowing for flexible and quick storage. The schema is contained in 
             database/schema.sql
"""
import sqlite3
import os
import utils
logger = utils.logging.getLogger(__name__)

class Database_Handler():
    def __init__(self):
        self.schema_file_path = os.path.join(os.path.dirname(__file__), 'database/schema.sql')
        self.db_file_path = os.path.join(os.path.dirname(__file__), 'database/local_db.sqlite')
        self.conn = sqlite3.connect(self.db_file_path)

    def initialze_database(self):
        with open(self.schema_file_path, 'r') as f:
            schema_sql = f.read()

        self.conn.executescript(schema_sql)
        self.conn.commit()